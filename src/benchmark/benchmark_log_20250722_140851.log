2025-07-22 14:08:51,413 - INFO - Using device: cuda
2025-07-22 14:08:53,271 - INFO - Loaded model from /scratch/avs7793/work_done/poseembroider/new_model/src/checkpoints/model_epoch_20.pth
2025-07-22 14:08:53,271 - INFO - Loading consolidated metadata from: /scratch/avs7793/work_done/poseembroider/new_model/src/data/processed/ALL_DATA.pt
2025-07-22 14:08:59,274 - INFO - Dataset initialized successfully. Total samples: 1309385
2025-07-22 14:08:59,345 - INFO - Test dataset size: 261877
2025-07-22 14:08:59,346 - INFO - Step 1: Computing/Loading collection features...
2025-07-22 14:08:59,346 - INFO - Computing collection features (ground truth embeddings)...
2025-07-22 14:23:31,804 - INFO - Features saved to: /scratch/avs7793/work_done/poseembroider/new_model/src/features_cache_2/collection_features.pt
2025-07-22 14:23:31,844 - INFO - Step 2: Computing/Loading retrieval features...
2025-07-22 14:23:31,844 - INFO - Computing retrieval features (fusion transformer outputs)...
2025-07-22 14:38:31,492 - INFO - Features saved to: /scratch/avs7793/work_done/poseembroider/new_model/src/features_cache_2/retrieval_features.pt
2025-07-22 14:38:31,552 - INFO - Step 3: Calculating recall metrics...
2025-07-22 14:38:31,552 - INFO - ==================================================
2025-07-22 14:38:31,553 - INFO - SINGLE-MODALITY QUERIES
2025-07-22 14:38:31,553 - INFO - ==================================================
2025-07-22 14:38:31,553 - INFO - ==================================================
2025-07-22 14:38:31,553 - INFO - DUAL-MODALITY QUERIES
2025-07-22 14:38:31,553 - INFO - ==================================================
2025-07-22 14:38:31,553 - INFO - Computing image_pose_input recall...
2025-07-22 14:38:31,553 - INFO - Query modalities: ['image', 'pose']
2025-07-22 14:38:31,553 - INFO - Collection modalities: ['image', 'pose', 'pressure']
2025-07-22 14:38:31,553 - INFO - Collection features: dict_keys(['image', 'pose', 'pressure'])
2025-07-22 14:38:31,553 - INFO - Retrieval features: dict_keys(['only_image_input', 'only_pose_input', 'only_pressure_input', 'image_pose_input', 'image_pressure_input', 'pose_pressure_input'])
2025-07-22 14:38:31,553 - INFO - Computing image+pose → pressure recall...
2025-07-22 16:08:33,196 - INFO - METRIC CALCULATED - image+pose→pressure_: {'image+pose→pressure_R@1': 0.013746911718096663, 'image+pose→pressure_R@5': 0.07331686249651555, 'image+pose→pressure_R@10': 0.15159788755789932}
2025-07-22 16:08:33,196 - INFO - AVERAGE RECALL for image+pose→pressure_: 0.08%
2025-07-22 16:08:33,196 - INFO - Computing image_pressure_input recall...
2025-07-22 16:08:33,196 - INFO - Query modalities: ['image', 'pressure']
2025-07-22 16:08:33,196 - INFO - Collection modalities: ['image', 'pose', 'pressure']
2025-07-22 16:08:33,196 - INFO - Collection features: dict_keys(['image', 'pose', 'pressure'])
2025-07-22 16:08:33,196 - INFO - Retrieval features: dict_keys(['only_image_input', 'only_pose_input', 'only_pressure_input', 'image_pose_input', 'image_pressure_input', 'pose_pressure_input'])
2025-07-22 16:08:33,196 - INFO - Computing image+pressure → pose recall...
2025-07-22 17:39:28,201 - INFO - METRIC CALCULATED - image+pressure→pose_: {'image+pressure→pose_R@1': 4.174860717054189, 'image+pressure→pose_R@5': 18.813794262191795, 'image+pressure→pose_R@10': 33.296547615865464}
2025-07-22 17:39:28,201 - INFO - AVERAGE RECALL for image+pressure→pose_: 18.76%
2025-07-22 17:39:28,201 - INFO - Computing pose_pressure_input recall...
2025-07-22 17:39:28,201 - INFO - Query modalities: ['pose', 'pressure']
2025-07-22 17:39:28,201 - INFO - Collection modalities: ['image', 'pose', 'pressure']
2025-07-22 17:39:28,201 - INFO - Collection features: dict_keys(['image', 'pose', 'pressure'])
2025-07-22 17:39:28,201 - INFO - Retrieval features: dict_keys(['only_image_input', 'only_pose_input', 'only_pressure_input', 'image_pose_input', 'image_pressure_input', 'pose_pressure_input'])
2025-07-22 17:39:28,201 - INFO - Computing pose+pressure → image recall...
2025-07-22 19:08:46,943 - INFO - METRIC CALCULATED - pose+pressure→image_: {'pose+pressure→image_R@1': 2.4969737701287245, 'pose+pressure→image_R@5': 11.607357652638454, 'pose+pressure→image_R@10': 21.1473325263387}
2025-07-22 19:08:46,943 - INFO - AVERAGE RECALL for pose+pressure→image_: 11.75%
2025-07-22 19:08:46,943 - INFO - ==================================================
2025-07-22 19:08:46,943 - INFO - SUMMARY METRICS
2025-07-22 19:08:46,943 - INFO - ==================================================
2025-07-22 19:08:46,943 - INFO - MEAN DUAL-MODALITY RECALL: 10.20%
2025-07-22 19:08:46,944 - INFO - All results saved to: /scratch/avs7793/work_done/poseembroider/new_model/src/checkpoints/benchmark_results.json
2025-07-22 19:08:46,944 - INFO - Detailed logs saved to: /scratch/avs7793/work_done/poseembroider/new_model/src/checkpoints/benchmark_log_20250722_140851.log
